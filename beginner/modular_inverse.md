## 선행

- 페르마의 소정리
- 분할정복을 이용한 빠른 거듭제곱

## 연관

- 이항 계수

# 모듈로 역원

> 페르마의 소정리를 기반으로 모듈로 역원을 계산해 봅시다.

페르마의 소정리의 식은 아래와 같다.

- $p$가 소수일 때, $a^p \equiv a\ (mod\ p)$

이는 다음과 같이 나타낼 수도 있다.

- $p$가 소수일 때, $a^{p-1} \equiv 1\ (mod\ p)$

이를 한번 더 변형하면 다음과 같이 변한다.

- $p$가 소수일 때, $a^{p-2} \equiv a^{-1}\ (mod\ p)$

이제 $a^{-1}\ mod\ p$가 $a^{p-2}\ mod\ p$와 같다는 것을 알았으므로, 해당 식을 곱해주면 된다.

- $x \times a^{-1}\ mod\ p \equiv x \times a^{p-2}\ mod\ p$

$a^{p-2}\ mod\ p$를 그냥 계산하면 오래 걸리므로, 분할정복으로 거듭제곱해주면 된다.

## 이항 계수

모듈로 역원을 이용해서 이항 계수를 계산할 수 있다.

${n \choose r}$을 계산한다고 하자. 그럼 아래와 같은 식을 구할 수 있다.

- ${n \choose r} = \frac{n!}{(n-r)! \times r!}$

팩토리얼 수는 숫자가 기하급수적으로 커지므로, 소수 $p$를 이용한 나머지 연산을 요구할 것이다. 위 식에 모듈로 역원을 취하면 아래와 같이 변한다.

- ${n \choose r} = n! \times ((n-r)! \times r!)^{p-2}$

이제 위 식에 mod 작업을 잘 수행해주면 나머지 연산이 적용된 이항 계수를 구할 수 있다.

## 연습문제

- [이항 계수 3[G1]](https://www.acmicpc.net/problem/11401)
- [이항 계수와 쿼리[P5]](https://www.acmicpc.net/problem/13977)
